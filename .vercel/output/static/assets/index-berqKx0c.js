import{u as j,a as N,b,R as v,f as w,r as p,z as n,g,j as e,U as C}from"./index-D68JyPnQ.js";import{P as E,a as P}from"./PortalLayout-DFkXF_dG.js";import{f as L,a as R,b as T}from"./formatTime-R4Jm2Dpf.js";import{L as A}from"./log-out-C9kJv6u3.js";import{C as c}from"./calendar-sVqVbs5g.js";import{C as O}from"./circle-x-YOFRGHgJ.js";import{C as k}from"./clock-04BLIM7u.js";import{M as D}from"./map-pin-BUW29wY0.js";import{C as B}from"./circle-alert-Cfu_jE4B.js";import"./Footer-CWCGcQgO.js";const V=function(){const r=j(),x=N(),{token:t,user:a,clearAuth:d}=b(),{view:u}=v.useSearch(),l=u==="bookings"?"all":"upcoming";w(),p.useEffect(()=>{if(!t||!a){n.error("Please log in to access the client portal"),r({to:"/"});return}a.role!=="CLIENT"&&(n.error("Access denied. Client account required."),r({to:"/"}))},[t,a,r]);const o=g(x.getUpcomingBookings.queryOptions(void 0,{enabled:!!t})),m=g(x.getAllBookings.queryOptions(void 0,{enabled:!!t}));p.useEffect(()=>{const s=o.error?.message,h=m.error?.message;(s?.includes("UNAUTHORIZED")||h?.includes("UNAUTHORIZED"))&&(d(),n.error("Your session has expired. Please log in again."),r({to:"/"}))},[o.error,m.error,d,r]);const f=()=>{d(),n.success("Logged out successfully"),r({to:"/"})};if(!t||!a)return null;const i=l==="upcoming"?o:m,y=s=>s?{CREDIT_CARD:"Credit Card",CASH:"Cash",ZELLE:"Zelle",VENMO:"Venmo",OTHER:"Other"}[s]||s:"N/A";return e.jsx(E,{portalType:"client",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary to-primary-dark text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold font-heading",children:"Welcome Back! ðŸ‘‹"}),e.jsx("p",{className:"mt-2 text-green-100 text-base",children:a.firstName||a.email})]}),e.jsxs("button",{onClick:f,className:"flex items-center justify-center gap-2 px-5 py-2.5 bg-white/10 backdrop-blur-sm text-white rounded-lg hover:bg-white/20 transition-all duration-200 border border-white/20 shadow-lg hover:shadow-xl self-start sm:self-center",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Logout"})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-1",children:e.jsxs("nav",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>r({to:"/client-portal",search:{view:"dashboard"}}),className:`flex-1 py-3 px-6 rounded-lg font-medium text-sm transition-all duration-200 ${l==="upcoming"?"bg-primary text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(c,{className:"w-4 h-4"}),"Upcoming Bookings"]})}),e.jsx("button",{onClick:()=>r({to:"/client-portal",search:{view:"bookings"}}),className:`flex-1 py-3 px-6 rounded-lg font-medium text-sm transition-all duration-200 ${l==="all"?"bg-primary text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),"All Bookings"]})})]})})}),i.isLoading?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading your bookings..."})]})}):i.isError?e.jsx("div",{className:"bg-red-50 rounded-xl shadow-sm border border-red-200 p-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(O,{className:"w-8 h-8 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-900 font-semibold text-lg mb-1",children:"Error Loading Bookings"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Please try refreshing the page"})]})]})}):i.data?.bookings.length===0?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(c,{className:"w-10 h-10 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 font-semibold text-lg mb-1",children:l==="upcoming"?"No Upcoming Bookings":"No Bookings Yet"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:l==="upcoming"?"You don't have any upcoming cleaning appointments":"Start by booking your first cleaning service"}),e.jsxs("button",{onClick:()=>r({to:"/book-now"}),className:"inline-flex items-center gap-2 px-6 py-2.5 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors font-medium",children:[e.jsx(c,{className:"w-4 h-4"}),"Book Now"]})]})]})}):e.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:i.data?.bookings.map(s=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-lg hover:border-primary/20 transition-all duration-300 overflow-hidden group",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-white p-4 border-b border-gray-100",children:e.jsx("div",{className:"text-sm font-semibold text-gray-600",children:s.serviceType})}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-gray-900 font-heading group-hover:text-primary transition-colors",children:s.serviceType}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(c,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-0.5",children:"Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:L(s.scheduledDate,{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(k,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-0.5",children:"Time"}),e.jsx("p",{className:"text-gray-900 font-medium",children:R(s.scheduledTime)}),s.durationHours!==null&&e.jsxs("p",{className:"text-gray-600 text-xs mt-1",children:["Duration: ",T(s.durationHours/Math.max(1,s.numberOfCleanersRequested||1)),s.numberOfCleanersRequested&&s.numberOfCleanersRequested>1?` â€¢ ${s.numberOfCleanersRequested} cleaners`:""]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(D,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-0.5",children:"Location"}),e.jsx("p",{className:"text-gray-900 font-medium line-clamp-2",children:s.address}),e.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Payment: ",y(s.paymentMethod)]})]})]}),s.cleaner&&e.jsx("div",{className:"pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(C,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-0.5",children:"Cleaner"}),e.jsxs("p",{className:"text-gray-900 font-medium",children:[s.cleaner.firstName," ",s.cleaner.lastName]}),s.cleaner.phone&&e.jsxs("a",{href:`tel:${s.cleaner.phone}`,className:"text-primary hover:text-primary-dark text-xs mt-1 inline-block",children:["ðŸ“ž ",s.cleaner.phone]})]})]})}),!s.cleaner&&e.jsx("div",{className:"pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-2 text-yellow-700 bg-yellow-50 rounded-lg p-2.5",children:[e.jsx(B,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"text-xs font-medium",children:"Awaiting cleaner assignment"})]})})]})]}),(s.finalPrice||s.specialInstructions)&&e.jsxs("div",{className:"px-5 pb-5 space-y-3",children:[s.finalPrice&&e.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-primary/10 rounded-lg p-3 border border-primary/20",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Price"}),e.jsxs("p",{className:"text-xl font-bold text-primary-dark",children:["$",s.finalPrice.toFixed(2)]})]}),s.specialInstructions&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 font-semibold mb-1.5",children:"Special Instructions"}),e.jsx("p",{className:"text-xs text-gray-700 leading-relaxed",children:s.specialInstructions})]})]})]},s.id))})]})]})})};export{V as component};
