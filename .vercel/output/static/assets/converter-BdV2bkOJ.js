var $={},J={},se;function V(){return se||(se=1,Object.defineProperty(J,"__esModule",{value:!0}),J.excelBOM=J.defaultCsv2JsonOptions=J.defaultJson2CsvOptions=J.errors=void 0,J.errors={optionsRequired:"Options were not passed and are required.",json2csv:{cannotCallOn:"Cannot call json2csv on",dataCheckFailure:"Data provided was not an array of documents.",notSameSchema:"Not all documents have the same schema."},csv2json:{cannotCallOn:"Cannot call csv2json on",dataCheckFailure:"CSV is not a string."}},J.defaultJson2CsvOptions={arrayIndexesAsKeys:!1,checkSchemaDifferences:!1,delimiter:{field:",",wrap:'"',eol:`
`},emptyFieldValue:void 0,escapeHeaderNestedDots:!0,excelBOM:!1,excludeKeys:[],expandNestedObjects:!0,expandArrayObjects:!1,prependHeader:!0,preventCsvInjection:!1,sortHeader:!1,trimFieldValues:!1,trimHeaderFields:!1,unwindArrays:!1,useDateIso8601Format:!1,useLocaleFormat:!1,wrapBooleans:!1,fieldTitleMap:Object.create({})},J.defaultCsv2JsonOptions={delimiter:{field:",",wrap:'"',eol:`
`},excelBOM:!1,preventCsvInjection:!1,trimFieldValues:!1,trimHeaderFields:!1},J.excelBOM="\uFEFF"),J}var P={},Q={};/**
 * @license MIT
 * doc-path <https://github.com/mrodrig/doc-path>
 * Copyright (c) 2015-present, Michael Rodrigues.
 */var ue;function te(){if(ue)return Q;ue=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.setPath=Q.evaluatePath=void 0;function C(i,a){if(!i)return null;const{dotIndex:t,key:r,remaining:c}=w(a),v=typeof i=="object"&&a in i?i[a]:void 0,h=typeof i=="object"&&r in i?i[r]:void 0;if(t>=0&&typeof i=="object"&&!(a in i)){const{key:D}=w(c),d=parseInt(D);return Array.isArray(h)&&isNaN(d)?h.map(f=>C(f,c)):C(h,c)}else if(Array.isArray(i)){const D=parseInt(r);return a===r&&t===-1&&!isNaN(D)?h:i.map(d=>C(d,a))}else{if(t>=0&&a!==r&&typeof i=="object"&&r in i)return C(h,c);if(t===-1&&typeof i=="object"&&r in i&&!(a in i))return h}return v}Q.evaluatePath=C;function F(i,a,t){if(i){if(!a)throw new Error("No keyPath was provided.")}else throw new Error("No object was provided.");return N(i,a,t)}Q.setPath=F;function N(i,a,t){const{dotIndex:r,key:c,remaining:v}=w(a);if(a.startsWith("__proto__")||a.startsWith("constructor")||a.startsWith("prototype"))return i;if(r>=0){const h=parseInt(c);if(typeof i=="object"&&i!==null&&!(c in i)&&Array.isArray(i)&&!isNaN(h))return i[c]=i[c]??{},N(i[c],v,t),i;if(typeof i=="object"&&i!==null&&!(c in i)&&Array.isArray(i))return i.forEach(D=>N(D,a,t)),i;if(typeof i=="object"&&i!==null&&!(c in i)&&!Array.isArray(i)){const{key:D}=w(v),d=parseInt(D);if(!isNaN(d))i[c]=[];else{if(v==="")return i[a]=t,i;i[c]={}}}N(i[c],v,t)}else if(Array.isArray(i)){const h=parseInt(c);return a===c&&r===-1&&!isNaN(h)?(i[c]=t,i):(i.forEach(D=>N(D,v,t)),i)}else i[c]=t;return i}function w(i){const a=E(i);return{dotIndex:a,key:i.slice(0,a>=0?a:void 0).replace(/\\./g,"."),remaining:i.slice(a+1)}}function E(i){for(let a=0;a<i.length;a++){const t=a>0?i[a-1]:"";if(i[a]==="."&&t!=="\\")return a}return-1}return Q}var q={},H={},ae;function he(){if(ae)return H;ae=1,Object.defineProperty(H,"__esModule",{value:!0}),H.isDocumentToRecurOn=H.flatten=H.unique=void 0;function C(w){return[...new Set(w)]}H.unique=C;function F(w){return[].concat(...w)}H.flatten=F;function N(w){return typeof w=="object"&&w!==null&&!Array.isArray(w)&&Object.keys(w).length}return H.isDocumentToRecurOn=N,H}var re={},le;function ge(){return le||(le=1,Object.defineProperty(re,"__esModule",{value:!0})),re}var ce;function ve(){return ce||(ce=1,function(C){var F=q&&q.__createBinding||(Object.create?function(d,f,g,A){A===void 0&&(A=g);var x=Object.getOwnPropertyDescriptor(f,g);(!x||("get"in x?!f.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return f[g]}}),Object.defineProperty(d,A,x)}:function(d,f,g,A){A===void 0&&(A=g),d[A]=f[g]}),N=q&&q.__setModuleDefault||(Object.create?function(d,f){Object.defineProperty(d,"default",{enumerable:!0,value:f})}:function(d,f){d.default=f}),w=q&&q.__importStar||function(d){if(d&&d.__esModule)return d;var f={};if(d!=null)for(var g in d)g!=="default"&&Object.prototype.hasOwnProperty.call(d,g)&&F(f,d,g);return N(f,d),f},E=q&&q.__exportStar||function(d,f){for(var g in d)g!=="default"&&!Object.prototype.hasOwnProperty.call(f,g)&&F(f,d,g)};Object.defineProperty(C,"__esModule",{value:!0}),C.deepKeysFromList=C.deepKeys=void 0;const i=w(he());E(ge(),C);function a(d,f){const g=D(f);return typeof d=="object"&&d!==null?r("",d,g):[]}C.deepKeys=a;function t(d,f){const g=D(f);return d.map(A=>typeof A=="object"&&A!==null?a(A,g):[])}C.deepKeysFromList=t;function r(d,f,g){const A=Object.keys(f).map(x=>{const R=h(d,v(x,g));return g.expandNestedObjects&&i.isDocumentToRecurOn(f[x])||g.arrayIndexesAsKeys&&Array.isArray(f[x])&&f[x].length?r(R,f[x],g):g.expandArrayObjects&&Array.isArray(f[x])?c(f[x],R,g):g.ignoreEmptyArrays&&Array.isArray(f[x])&&!f[x].length?[]:R});return i.flatten(A)}function c(d,f,g){let A=t(d,g);return d.length?d.length&&i.flatten(A).length===0?[f]:(A=A.map(x=>Array.isArray(x)&&x.length===0?[f]:x.map(R=>h(f,v(R,g)))),i.unique(i.flatten(A))):g.ignoreEmptyArraysWhenExpanding?[]:[f]}function v(d,f){return f.escapeNestedDots?d.replace(/\./g,"\\."):d}function h(d,f){return d?d+"."+f:f}function D(d){return{arrayIndexesAsKeys:!1,expandNestedObjects:!0,expandArrayObjects:!1,ignoreEmptyArraysWhenExpanding:!1,escapeNestedDots:!1,ignoreEmptyArrays:!1,...d??{}}}}(q)),q}var p={},de;function ne(){if(de)return p;de=1,Object.defineProperty(p,"__esModule",{value:!0}),p.isInvalid=p.flatten=p.unique=p.arrayDifference=p.isError=p.isUndefined=p.isNull=p.isObject=p.isString=p.isNumber=p.unwind=p.getNCharacters=p.removeEmptyFields=p.isEmptyField=p.computeSchemaDifferences=p.isDateRepresentation=p.isStringRepresentation=p.deepCopy=p.validate=p.buildC2JOptions=p.buildJ2COptions=void 0;const C=te(),F=V(),N=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,w=1e5;function E(n){return{...F.defaultJson2CsvOptions,...n,delimiter:{field:n?.delimiter?.field??F.defaultJson2CsvOptions.delimiter.field,wrap:n?.delimiter?.wrap||F.defaultJson2CsvOptions.delimiter.wrap,eol:n?.delimiter?.eol||F.defaultJson2CsvOptions.delimiter.eol},fieldTitleMap:n?.fieldTitleMap||Object.create({})}}p.buildJ2COptions=E;function i(n){return{...F.defaultCsv2JsonOptions,...n,delimiter:{field:n?.delimiter?.field??F.defaultCsv2JsonOptions.delimiter.field,wrap:n?.delimiter?.wrap||F.defaultCsv2JsonOptions.delimiter.wrap,eol:n?.delimiter?.eol||F.defaultCsv2JsonOptions.delimiter.eol}}}p.buildC2JOptions=i;function a(n,l,o){if(!n)throw new Error(`${o.cannotCallOn} ${n}.`);if(!l(n))throw new Error(o.dataCheckFailure);return!0}p.validate=a;function t(n){return JSON.parse(JSON.stringify(n))}p.deepCopy=t;function r(n,l){const o=n[0],s=n.length-1,_=n[s];return o===l.delimiter.wrap&&_===l.delimiter.wrap}p.isStringRepresentation=r;function c(n){return N.test(n)}p.isDateRepresentation=c;function v(n,l){return T(n,l).concat(T(l,n))}p.computeSchemaDifferences=v;function h(n){return B(n)||L(n)||n===""}p.isEmptyField=h;function D(n){return n.filter(l=>!h(l))}p.removeEmptyFields=D;function d(n,l,o){return n.substring(l,l+o)}p.getNCharacters=d;function f(n,l,o){const s=(0,C.evaluatePath)(l,o);let _=t(l);Array.isArray(s)&&s.length?s.forEach(j=>{_=t(l),n.push((0,C.setPath)(_,o,j))}):(Array.isArray(s)&&s.length===0&&(0,C.setPath)(_,o,""),n.push(_))}function g(n,l){const o=[];return n.forEach(s=>{f(o,s,l)}),o}p.unwind=g;function A(n){return!isNaN(Number(n))}p.isNumber=A;function x(n){return typeof n=="string"}p.isString=x;function R(n){return typeof n=="object"}p.isObject=R;function L(n){return n===null}p.isNull=L;function B(n){return typeof n>"u"}p.isUndefined=B;function Y(n){return Object.prototype.toString.call(n)==="[object Error]"}p.isError=Y;function T(n,l){return n.filter(o=>!l.includes(o))}p.arrayDifference=T;function G(n){return[...new Set(n)]}p.unique=G;function Z(n){if(n.flat)return n.flat();if(n.length>w){let l=[];for(let o=0;o<n.length;o+=w)l=l.concat(...n.slice(o,o+w));return l}return n.reduce((l,o)=>l.concat(o),[])}p.flatten=Z;function u(n){return n===1/0||n===-1/0}return p.isInvalid=u,p}var fe;function Oe(){if(fe)return P;fe=1;var C=P&&P.__createBinding||(Object.create?function(r,c,v,h){h===void 0&&(h=v);var D=Object.getOwnPropertyDescriptor(c,v);(!D||("get"in D?!c.__esModule:D.writable||D.configurable))&&(D={enumerable:!0,get:function(){return c[v]}}),Object.defineProperty(r,h,D)}:function(r,c,v,h){h===void 0&&(h=v),r[h]=c[v]}),F=P&&P.__setModuleDefault||(Object.create?function(r,c){Object.defineProperty(r,"default",{enumerable:!0,value:c})}:function(r,c){r.default=c}),N=P&&P.__importStar||function(r){if(r&&r.__esModule)return r;var c={};if(r!=null)for(var v in r)v!=="default"&&Object.prototype.hasOwnProperty.call(r,v)&&C(c,r,v);return F(c,r),c};Object.defineProperty(P,"__esModule",{value:!0}),P.Json2Csv=void 0;const w=te(),E=ve(),i=V(),a=N(ne()),t=function(r){const c=new RegExp(r.delimiter.wrap,"g"),v=/\r?\n|\r/,h=r.parseValue&&typeof r.parseValue=="function"?r.parseValue:null,D=r.expandArrayObjects&&!r.unwindArrays,d={arrayIndexesAsKeys:r.arrayIndexesAsKeys,expandNestedObjects:r.expandNestedObjects,expandArrayObjects:D,ignoreEmptyArraysWhenExpanding:D,escapeNestedDots:!0};function f(e){return(0,E.deepKeysFromList)(e,d)}function g(e){return e.length===0?[]:r.checkSchemaDifferences?A(e):a.unique(a.flatten(e))}function A(e){const y=e[0],O=e.slice(1);if(x(y,O))throw new Error(i.errors.json2csv.notSameSchema);return y}function x(e,y){return y.reduce((O,b)=>a.computeSchemaDifferences(e,b).length>0?O+1:O,0)}function R(e){return r.excludeKeys?e.filter(y=>{for(const O of r.excludeKeys){const b=O instanceof RegExp?O:new RegExp(`^${O}`);if(O===y||y.match(b))return!1}return!0}):e}function L(e){return r.sortHeader&&typeof r.sortHeader=="function"?e.sort(r.sortHeader):r.sortHeader?e.sort():e}function B(e){return r.trimHeaderFields&&(e.headerFields=e.headerFields.map(y=>y.split(".").map(O=>O.trim()).join("."))),e}function Y(e){return r.prependHeader&&(e.headerFields=e.headerFields.map(function(y){return K(y)})),e}function T(e){const y=Object.keys(r.fieldTitleMap);return e.header=e.headerFields.map(function(O){let b=O;return y.includes(O)?b=r.fieldTitleMap[O]:r.escapeHeaderNestedDots||(b=b.replace(/\\\./g,".")),b}).join(r.delimiter.field),e}function G(){return r.keys?r.keys.map(e=>typeof e=="object"&&"field"in e?(r.fieldTitleMap[e.field]=e.title??e.field,e.field):e):[]}function Z(){return r.keys?r.keys.flatMap(e=>typeof e=="string"?[]:e?.wildcardMatch?e.field:[]):[]}function u(e){const y=Z(),O=G(),b=f(e),I=g(b);if(r.keys){r.keys=O;const k=O.flatMap(X=>{if(!y.includes(X))return X;const ie=[],me=new RegExp(`^${X}`);for(const ee of I)(X===ee||ee.match(me))&&ie.push(ee);return ie});if(!r.unwindArrays){const X=R(k);return L(X)}}const U=R(I);return L(U)}function n(e){for(const y of e.records)for(const O of e.headerFields){const b=(0,w.evaluatePath)(y,O);if(Array.isArray(b))return!0}return!1}function l(e,y=!1){if(r.unwindArrays){if(e.headerFields.forEach(O=>{e.records=a.unwind(e.records,O)}),e.headerFields=u(e.records),n(e))return l(e,y);if(!y)return l(e,!0);if(r.keys){const O=G();e.headerFields=R(O)}return e}return e}function o(e){return e.recordString=e.records.map(y=>{const O=_(y,e.headerFields),b=O.map(I=>{I=S(I),I=M(I);let U=h?h(I,j):j(I);return U=K(U),U});return m(b)}).join(r.delimiter.eol),e}function s(e){const y=a.removeEmptyFields(e);return!e.length||!y.length?r.emptyFieldValue||"":y.length===1?y[0]:e}function _(e,y){const O=[];return y.forEach(b=>{let I=(0,w.evaluatePath)(e,b);!a.isUndefined(r.emptyFieldValue)&&a.isEmptyField(I)?I=r.emptyFieldValue:r.expandArrayObjects&&Array.isArray(I)&&(I=s(I)),O.push(I)}),O}function j(e){const y=e instanceof Date;return e===null||Array.isArray(e)||typeof e=="object"&&!y?JSON.stringify(e):typeof e>"u"?"undefined":y&&r.useDateIso8601Format?e.toISOString():r.useLocaleFormat?e.toLocaleString():e.toString()}function S(e){return r.trimFieldValues?Array.isArray(e)?e.map(S):typeof e=="string"?e.trim():e:e}function M(e){return r.preventCsvInjection?Array.isArray(e)?e.map(M):typeof e=="string"&&!a.isNumber(e)?e.replace(/^[=+\-@\t\r]+/g,""):e:e}function K(e){const y=r.delimiter.wrap;return e.includes(r.delimiter.wrap)&&(e=e.replace(c,y+y)),(e.includes(r.delimiter.field)||e.includes(r.delimiter.wrap)||e.match(v)||r.wrapBooleans&&(e==="true"||e==="false"))&&(e=y+e+y),e}function m(e){return e.join(r.delimiter.field)}function z(e){const y=e.header,O=e.recordString;return(r.excelBOM?i.excelBOM:"")+(r.prependHeader?y+r.delimiter.eol:"")+O}function ye(e){Array.isArray(e)||(e=[e]);const y={headerFields:u(e),records:e,header:"",recordString:""},O=l(y),b=o(O),I=Y(b),U=B(I),k=T(U);return z(k)}return{convert:ye}};return P.Json2Csv=t,P}var W={},oe;function we(){if(oe)return W;oe=1;var C=W&&W.__createBinding||(Object.create?function(t,r,c,v){v===void 0&&(v=c);var h=Object.getOwnPropertyDescriptor(r,c);(!h||("get"in h?!r.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return r[c]}}),Object.defineProperty(t,v,h)}:function(t,r,c,v){v===void 0&&(v=c),t[v]=r[c]}),F=W&&W.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:!0,value:r})}:function(t,r){t.default=r}),N=W&&W.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var c in t)c!=="default"&&Object.prototype.hasOwnProperty.call(t,c)&&C(r,t,c);return F(r,t),r};Object.defineProperty(W,"__esModule",{value:!0}),W.Csv2Json=void 0;const w=te(),E=V(),i=N(ne()),a=function(t){const r=new RegExp(t.delimiter.wrap+t.delimiter.wrap,"g"),c=new RegExp("^"+E.excelBOM),v=t.parseValue&&typeof t.parseValue=="function"?t.parseValue:JSON.parse;function h(u){return u=B(u),t.trimHeaderFields?u.split(".").map(n=>n.trim()).join("."):u}function D(u){let n=[];if(t.headerFields)n=t.headerFields.map((l,o)=>({value:h(l),index:o}));else if(n=u[0].map((o,s)=>({value:h(o),index:s})),t.keys){const o=t.keys;n=n.filter(s=>o.includes(s.value))}return{lines:u,headerFields:n,recordLines:[]}}function d(u){return t.excelBOM?u.replace(c,""):u}function f(u){const n=[],l=u.length-1,o=t.delimiter.eol.length,s={insideWrapDelimiter:!1,parsingValue:!0,justParsedDoubleQuote:!1,startIndex:0};let _=[],j,S,M,K,m=0;for(;m<u.length;){if(j=u[m],S=m?u[m-1]:"",M=m<l?u[m+1]:"",K=i.getNCharacters(u,m,o),(K===t.delimiter.eol&&!s.insideWrapDelimiter||m===l)&&S===t.delimiter.field)K===t.delimiter.eol&&s.startIndex===m||j===t.delimiter.field?_.push(""):_.push(u.substring(s.startIndex)),_.push(""),n.push(_),_=[],s.startIndex=m+o,s.parsingValue=!0,s.insideWrapDelimiter=M===t.delimiter.wrap;else if(m===l&&j===t.delimiter.field){const z=u.substring(s.startIndex,m);_.push(z),_.push(""),n.push(_)}else if(m===l||K===t.delimiter.eol&&(!s.insideWrapDelimiter||s.insideWrapDelimiter&&S===t.delimiter.wrap&&!s.justParsedDoubleQuote)){const z=m!==l||S===t.delimiter.wrap?m:void 0;_.push(u.substring(s.startIndex,z)),n.push(_),_=[],s.startIndex=m+o,s.parsingValue=!0,s.insideWrapDelimiter=M===t.delimiter.wrap}else if(j===t.delimiter.wrap&&S===t.delimiter.field&&!s.insideWrapDelimiter&&!s.parsingValue)s.startIndex=m,s.insideWrapDelimiter=!0,s.parsingValue=!0,i.getNCharacters(u,m+1,o)===t.delimiter.eol&&(m+=t.delimiter.eol.length+1);else if(S===t.delimiter.field&&j===t.delimiter.wrap&&M===t.delimiter.eol)_.push(u.substring(s.startIndex,m-1)),s.startIndex=m,s.parsingValue=!0,s.insideWrapDelimiter=!0,s.justParsedDoubleQuote=!0,m+=1;else if((S!==t.delimiter.wrap||s.justParsedDoubleQuote&&S===t.delimiter.wrap)&&j===t.delimiter.wrap&&i.getNCharacters(u,m+1,o)===t.delimiter.eol)s.insideWrapDelimiter=!1,s.parsingValue=!1;else if(j===t.delimiter.wrap&&(m===0||i.getNCharacters(u,m-o,o)===t.delimiter.eol&&!s.insideWrapDelimiter))s.insideWrapDelimiter=!0,s.parsingValue=!0,s.startIndex=m;else if(j===t.delimiter.wrap&&M===t.delimiter.field&&s.insideWrapDelimiter)_.push(u.substring(s.startIndex,m+1)),s.startIndex=m+2,s.insideWrapDelimiter=!1,s.parsingValue=!1;else if(j===t.delimiter.wrap&&S===t.delimiter.field&&!s.insideWrapDelimiter&&s.parsingValue)_.push(u.substring(s.startIndex,m-1)),s.insideWrapDelimiter=!0,s.parsingValue=!0,s.startIndex=m;else if(j===t.delimiter.wrap&&M===t.delimiter.wrap&&m!==s.startIndex){m+=2,s.justParsedDoubleQuote=!0;continue}else j===t.delimiter.field&&S!==t.delimiter.wrap&&M!==t.delimiter.wrap&&!s.insideWrapDelimiter&&s.parsingValue?(_.push(u.substring(s.startIndex,m)),s.startIndex=m+1):j===t.delimiter.field&&S===t.delimiter.wrap&&M!==t.delimiter.wrap&&!s.parsingValue&&(s.insideWrapDelimiter=!1,s.parsingValue=!0,s.startIndex=m+1);m++,s.justParsedDoubleQuote=!1}return n}function g(u){return t.headerFields?u.recordLines=u.lines:u.recordLines=u.lines.splice(1),u}function A(u,n){const l=n[u.index];return x(l)}function x(u){const n=G(u);return!i.isError(n)&&!i.isInvalid(n)?n:u==="undefined"?void 0:u}function R(u){return t.trimFieldValues&&u!==null?u.trim():u}function L(u,n){return u.reduce((l,o)=>{const s=A(o,n);try{return(0,w.setPath)(l,o.value,s)}catch{return l}},{})}function B(u){const n=u[0],l=u.length-1,o=u[l];return n===t.delimiter.wrap&&o===t.delimiter.wrap?u.length<=2?"":u.substring(1,l):u}function Y(u){return u.replace(r,t.delimiter.wrap)}function T(u){return u.recordLines.reduce((n,l)=>{l=l.map(s=>(s=B(s),s=Y(s),s=R(s),s));const o=L(u.headerFields,l);return n.concat(o)},[])}function G(u){try{if(i.isStringRepresentation(u,t)&&!i.isDateRepresentation(u))return u;const n=v(u);return Array.isArray(n)?n.map(R):n}catch(n){return n}}function Z(u){const n=d(u),l=f(n),o=D(l),s=g(o);return T(s)}return{convert:Z}};return W.Csv2Json=a,W}var pe;function _e(){if(pe)return $;pe=1,Object.defineProperty($,"__esModule",{value:!0}),$.csv2json=$.json2csv=void 0;const C=V(),F=Oe(),N=we(),w=ne();function E(a,t){const r=(0,w.buildJ2COptions)(t??{});return(0,w.validate)(a,w.isObject,C.errors.json2csv),(0,F.Json2Csv)(r).convert(a)}$.json2csv=E;function i(a,t){const r=(0,w.buildC2JOptions)(t??{});return(0,w.validate)(a,w.isString,C.errors.csv2json),(0,N.Csv2Json)(r).convert(a)}return $.csv2json=i,$}var De=_e();export{De as c};
